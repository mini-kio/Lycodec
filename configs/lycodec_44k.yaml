sample_rate: 44100
stft:
  n_fft: 2048
  hop_length: 588
  win_length: 2048
crop_seconds: 1.5
chunk_seconds: 1.5
hop_seconds: 0.75
batch_size: 12
epochs: 2000
lr: 0.00003  # ðŸ”§ REDUCED: 5e-5 â†’ 3e-5 for stability
device: cuda
num_workers: 12
save_every: 1000

# Model configuration (â‰ˆ151M params)
model:
  hidden_dim: 768
  token_dim: 384
  transformer_layers: 10
  heads: 12
  use_rope: true
  token_rate_hz: 24

  pq_M: 4
  pq_K: 256
  ema_decay: 0.97
  awakening_steps: 1000
  drop_start: 0.6
  drop_end: 0.3  # ðŸ”§ RELAXED: 0.2 â†’ 0.3 (keep some dropout longer)
  drop_decay_steps: 100000  # ðŸ”§ SLOWER: 80k â†’ 100k

  use_residual_corrector: true
  corrector_alpha: 0.2

  decoder_depth: 7
  decoder_patch_size: 32
  decoder_embed_dim: 512
  decoder_mlp_ratio: 3.0
  decoder_cond_ch: 48

train:
  grad_clip: 1.0
  use_amp: true
  gradient_accumulation_steps: 4
  use_checkpoint: true

  quantizer_warmup_steps: 1000

  # ðŸ”§ GENTLER SCHEDULES - More gradual ramp-up
  residual_weight_schedule:
    - [0, 0.0]
    - [5000, 0.05]   # Slower start
    - [20000, 0.15]  # 0.3 â†’ 0.15
    - [40000, 0.25]  # New intermediate step
    - [60000, 0.35]  # Spread out
    - [100000, 0.45] # Lower final target

  alignment_weight_schedule:
    - [0, 0.0]
    - [20000, 0.005]  # Much gentler
    - [40000, 0.015]  # 0.03 â†’ 0.015
    - [70000, 0.025]  # Slower increase
    - [120000, 0.04]  # Lower final

  contrast_weight_schedule:
    - [0, 0.0]
    - [10000, 0.005]  # Gentler start
    - [30000, 0.015]  # 0.03 â†’ 0.015
    - [60000, 0.03]   # 0.05 â†’ 0.03
    - [100000, 0.05]  # Later peak

  index_ce_weight_schedule:
    - [0, 0.0]
    - [5000, 0.05]    # Slower start
    - [20000, 0.2]    # 0.3 â†’ 0.2
    - [50000, 0.35]   # Spread out
    - [80000, 0.5]    # Lower final target
    - [120000, 0.6]   # Very gradual

  # Consistency model
  sigma_min: 0.002
  sigma_max: 80.0
  rho: 7.0
  use_ema_teacher: true
  decode_chunk: 2

  ema:
    enabled: true
    decay: 0.995

data:
  wav_exts: [".wav", ".flac", ".mp3"]
  segment_seconds: 1.5
  stereo: true

output:
  ckpt_dir: runs/ckpts
  log_dir: runs/logs
  resume_ckpt: "auto"

logging:
  use_wandb: true
  project: lycodec
  run_name: lycodec_44k